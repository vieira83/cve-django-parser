{% load staticfiles %}
{% load bootstrap3 %}
{% bootstrap_css %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<div class="cve_container">
    <header>
        <div class="cve_header">
            <h1 class="cve_title">Common Vulnerabilities and Exposures(CVE)</h1>
            <p class="cve_description">This a Graph containing a list of CVEs recently modified and grouped per day.</p>
        </div>

    </header>
    <section class="cve_main_section">
        <div class="container">
            <div class="row row-centered">
                <div class="col-sm-8">
                    <div id="cve-group">
                        {% csrf_token %}
                        <div class="cve_Wrapper">
                            <p class="help"></p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="cve_list col-centered">
                         <div class="cve-list_table-title"><span>Table View</span></div>
                        <div>
                            <div class="cve-list_table-head">
                                <span class="date_header cve_list_date">Date</span>
                                <span class="count_header cve_list_count">Count</span>
                            </div>
                            {% for cve in cves_count %}
                            <div class="cve_list_row">
                                <span class="cve_list_date">{{ cve.date }}</span>
                                <span class="cve_list_count"> {{ cve.count }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script type="text/javascript">
    $(function () {
        var cves = {{group_CVEs |safe}},
        cve_date = [],
        cve_count = [],
        myChart;

        cves.forEach(function(cve){
          cve_date.push(cve.date);
          cve_count.push(parseInt(cve.count));
        });

        var myChart = Highcharts.chart('cve-group', {
            chart: {
                type: 'bar'
            },
            title: {
                text: 'Graph of CVEs Modified By Day'
            },
            xAxis: {
                categories: cve_date,
                title: { text: 'DATE'}
            },
            yAxis: {
                title: {
                    text: 'CVE Count'
                }
            },
            series: [{
                name: 'CVE',
                data: cve_count
            }]
        });
    })
    </script>
</div>