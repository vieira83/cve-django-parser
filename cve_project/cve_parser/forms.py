from django import forms
from datetime import datetime
from django.forms import ModelForm, HiddenInput, widgets
from cve_parser.models import CVEEntry


class ReadOnlyWidget(widgets.Widget):
    def render(self, _, value, attrs=None):
        return value


class CVEEntryForm(forms.ModelForm):

    def save(self, commit=True):
        instance = super(CVEEntryForm, self).save(commit=False)
        if self.changed_data:
            instance.last_modified_time = datetime.now()
            instance.save()
        return instance

    class Meta:
        model = CVEEntry
        fields = ['published_time', 'cve_id', 'summary', 'security_protection', 'cwe', 'software_list', 'reference',
                  'cvss_base_metrics', 'last_modified_time']
